---
import type { ComponentProps, HTMLAttributes } from 'astro/types';
import Link from '../Link/Link.astro';
import Card from './Card.astro';

interface Props extends ComponentProps<typeof Card> {
  place?: string;
  link?: string; // a place link can be provided only if place is defined
  roleTitle: string;
  year: number | `${number} - ${number}`;
  target?: HTMLAttributes<'a'>['target'];
}

const {
  place,
  roleTitle,
  year,
  link,
  target = '_blank',
  ...props
} = Astro.props;

const Wrapper = link ? Link : Fragment;
const wrapperProps = link
  ? {
      href: link,
      target,
      rel: 'noopener noreferrer',
      variant: 'unstyled',
    }
  : {};
---

<Wrapper {...props} {...wrapperProps}>
  <Card class='p-6'>
    <div class='flex flex-col gap-6 md:flex-row'>
      <div
        class='bg-danger flex h-20 w-20 flex-shrink-0 items-center justify-center rounded-xl md:h-24 md:w-24'
      >
        <span class='text-2xl font-bold text-white'>{year}</span>
      </div>
      <div>
        <h3 class='text-secondary mb-2 text-xl font-bold'>{roleTitle}</h3>
        {
          place ? (
            <p class='bg-accent3 border-comic border-secondary mb-3 px-2 py-1 font-semibold whitespace-break-spaces md:w-fit'>
              {place}
            </p>
          ) : null
        }
        <slot />
      </div>
    </div>
  </Card>
</Wrapper>
