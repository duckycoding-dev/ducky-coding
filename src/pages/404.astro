---
import HolyGrailLayout from '@layouts/HolyGrailLayout/HolyGrailLayout.astro';
import { Image } from 'astro:assets';
import duck404 from '@assets/images/404_duck.png';
import Link from '@components/Link/Link.astro';
import { IMAGE_DENSITIES } from '@utils/globals';
---

<HolyGrailLayout
  title='404'
  seoProps={{
    title: '404',
    description:
      '404 error page: the requested page or resource does not exist on this website',
    extend: {
      meta: [
        {
          name: 'keywords',
          content: 'DuckyCoding, 404, missing resource, missing page, error',
        },
      ],
    },
  }}
>
  <h1
    class='mx-auto mb-8 text-center text-3xl font-extrabold text-balance md:max-w-[50%]'
  >
    The page or resource you requested could not be found <span
      aria-hidden='true'>:(</span
    >
  </h1>
  <Image
    src={duck404}
    alt="duck illustration representing a 404 error, generated by Microsoft's Bing Copilot"
    class='mx-auto max-h-96 object-contain'
    densities={IMAGE_DENSITIES}
    loading='lazy'
    decoding='async'
  />
  <h2
    class='previous-page mx-auto mt-8 text-center text-2xl font-extrabold text-balance'
  >
    Go back to the <Link class='text-2xl' href='/'>previous page</Link>
  </h2>
  <h3
    class='previous-page mx-auto text-center text-xl font-extrabold text-balance'
  >
    or
  </h3>
  <h2 class='mx-autotext-balance text-center text-2xl font-extrabold'>
    Go back to the <Link class='text-2xl' href='/'>home page</Link>
  </h2>
</HolyGrailLayout>

<script>
  const previousUrl = document.referrer;
  const previousPageExists = window.history.length > 1 && previousUrl;
  const previousPageElements = document.querySelectorAll('.previous-page');

  // removes call to action link to previous page if
  // there is not previous page to go to
  previousPageElements.forEach((element) => {
    if (!previousPageExists) element.remove();
  });

  const previousPageLink = document.querySelector('.previous-page>*');
  previousPageLink?.setAttribute('href', previousUrl);
</script>
