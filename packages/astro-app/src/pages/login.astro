---
import { HolyGrailLayout } from '@layouts/HolyGrailLayout';
import { Button } from '@components/Button';
import { GET } from './api/v1/auth/verify-user';
import { Link } from '../components/Link';
import { InputWithLabel } from '../components/Form/InputWithLabel';

export const prerender = false;
const res = await (await GET(Astro)).json();

if (res.user) {
  return Astro.redirect('/');
}
---

<HolyGrailLayout
  title='Login'
  seoProps={{
    title: 'Login',
    description:
      "Login into your DuckyCoding's blog account: manage your favorite posts!",
    extend: {
      meta: [
        {
          name: 'keywords',
          content: 'login, DuckyCoding, web development, auth',
        },
      ],
    },
  }}
>
  <h1 class='mb-8 text-center text-4xl font-extrabold'>Login</h1>
  <p class='mb-8 text-center text-lg'>
    Access your account to manage your favorite posts and customize your
    experience!
  </p>
  <form action='/api/v1/auth/login' method='post' class='flex flex-col gap-4'>
    <InputWithLabel
      type='text'
      name='username'
      id='username'
      title='Username'
      placeholder='Your username'
    >
      Username
    </InputWithLabel>
    <InputWithLabel
      type='password'
      name='password'
      id='password'
      title='Password'
      placeholder='Your password'
    >
      Password
    </InputWithLabel>

    <Button class={'w-full mt-4'} type='submit' variant={'contained'}
      >Login</Button
    >
  </form>

  <p class='mt-8 text-center'>
    Don't have an account?
    <Link href='/signup' class={'font-extrabold'}> Sign up now! </Link>
  </p>
</HolyGrailLayout>
