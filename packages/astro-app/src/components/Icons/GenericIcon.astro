---
import type { HTMLAttributes } from 'astro/types';
import { Icon } from 'astro-icon/components';
import { cva, type VariantProps } from 'class-variance-authority';

const genericIconVariants = cva('', {
  variants: {
    variant: {
      small: 25,
      medium: 50,
      large: 100,
    },
  },
  defaultVariants: {
    variant: 'medium',
  },
  compoundVariants: [],
});

export type GenericIconVariantsProps = VariantProps<typeof genericIconVariants>;
export type AstroIconDimensions =
  | {
      size: number;
      width?: undefined;
      height?: undefined;
      variant?: undefined;
    }
  | {
      size?: undefined;
      width: number;
      height: number;
      variant?: undefined;
    }
  | ({
      size?: undefined;
      width?: undefined;
      height?: undefined;
    } & Pick<GenericIconVariantsProps, 'variant'>);

export interface AstroIconNamingProps {
  name: string;
  title: string;
  'is:inline'?: boolean;
}

export type GenericIconProps = HTMLAttributes<'svg'> &
  AstroIconNamingProps &
  AstroIconDimensions;

type Props = GenericIconProps;

const { variant, size, width, height, ...props } = Astro.props;

let customSize =
  size || Number(genericIconVariants({ variant: variant })) || undefined;
if (width && height) customSize = undefined;
---

<Icon
  size={customSize}
  width={width || Number(genericIconVariants({ variant: variant })) || 0}
  height={height || Number(genericIconVariants({ variant: variant })) || 0}
  {...props}
/>
